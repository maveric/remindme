"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/businesses/[id]/documents/route";
exports.ids = ["app/api/businesses/[id]/documents/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute&page=%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute.ts&appDir=%2Fhome%2Fmav%2Fprojects%2Fpermit-buddy%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fmav%2Fprojects%2Fpermit-buddy&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute&page=%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute.ts&appDir=%2Fhome%2Fmav%2Fprojects%2Fpermit-buddy%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fmav%2Fprojects%2Fpermit-buddy&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_mav_projects_permit_buddy_app_api_businesses_id_documents_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/businesses/[id]/documents/route.ts */ \"(rsc)/./app/api/businesses/[id]/documents/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/businesses/[id]/documents/route\",\n        pathname: \"/api/businesses/[id]/documents\",\n        filename: \"route\",\n        bundlePath: \"app/api/businesses/[id]/documents/route\"\n    },\n    resolvedPagePath: \"/home/mav/projects/permit-buddy/app/api/businesses/[id]/documents/route.ts\",\n    nextConfigOutput,\n    userland: _home_mav_projects_permit_buddy_app_api_businesses_id_documents_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/businesses/[id]/documents/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZidXNpbmVzc2VzJTJGJTVCaWQlNUQlMkZkb2N1bWVudHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmJ1c2luZXNzZXMlMkYlNUJpZCU1RCUyRmRvY3VtZW50cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmJ1c2luZXNzZXMlMkYlNUJpZCU1RCUyRmRvY3VtZW50cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGbWF2JTJGcHJvamVjdHMlMkZwZXJtaXQtYnVkZHklMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmhvbWUlMkZtYXYlMkZwcm9qZWN0cyUyRnBlcm1pdC1idWRkeSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDMEI7QUFDdkc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vP2Q1YmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL2hvbWUvbWF2L3Byb2plY3RzL3Blcm1pdC1idWRkeS9hcHAvYXBpL2J1c2luZXNzZXMvW2lkXS9kb2N1bWVudHMvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2J1c2luZXNzZXMvW2lkXS9kb2N1bWVudHMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9idXNpbmVzc2VzL1tpZF0vZG9jdW1lbnRzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9idXNpbmVzc2VzL1tpZF0vZG9jdW1lbnRzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvbWF2L3Byb2plY3RzL3Blcm1pdC1idWRkeS9hcHAvYXBpL2J1c2luZXNzZXMvW2lkXS9kb2N1bWVudHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2J1c2luZXNzZXMvW2lkXS9kb2N1bWVudHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute&page=%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute.ts&appDir=%2Fhome%2Fmav%2Fprojects%2Fpermit-buddy%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fmav%2Fprojects%2Fpermit-buddy&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/businesses/[id]/documents/route.ts":
/*!****************************************************!*\
  !*** ./app/api/businesses/[id]/documents/route.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.ts\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n/* harmony import */ var _lib_ensure_profile__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/ensure-profile */ \"(rsc)/./lib/ensure-profile.ts\");\n/* harmony import */ var _lib_storage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/storage */ \"(rsc)/./lib/storage.ts\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\nconst runtime = \"nodejs\";\nfunction resolveErrorMessage(error, fallback) {\n    if (error instanceof Error && error.message) {\n        return error.message;\n    }\n    return fallback;\n}\nfunction parseId(source) {\n    const value = Number(source);\n    if (!Number.isFinite(value) || value <= 0) {\n        return null;\n    }\n    return value;\n}\nfunction normalizeCategory(value) {\n    if (typeof value === \"string\") {\n        const normalized = value.trim().toUpperCase();\n        if (Object.values(_prisma_client__WEBPACK_IMPORTED_MODULE_5__.DocumentCategory).includes(normalized)) {\n            return normalized;\n        }\n    }\n    return _prisma_client__WEBPACK_IMPORTED_MODULE_5__.DocumentCategory.PERMIT;\n}\nfunction normalizeStatus(value) {\n    if (typeof value === \"string\") {\n        const normalized = value.trim().toUpperCase().replace(/[\\s-]+/g, \"_\");\n        if (Object.values(_prisma_client__WEBPACK_IMPORTED_MODULE_5__.DocumentStatus).includes(normalized)) {\n            return normalized;\n        }\n    }\n    return _prisma_client__WEBPACK_IMPORTED_MODULE_5__.DocumentStatus.ACTIVE;\n}\nfunction parseDate(value) {\n    if (typeof value !== \"string\") {\n        return null;\n    }\n    const trimmed = value.trim();\n    if (!trimmed) {\n        return null;\n    }\n    const parsed = new Date(trimmed);\n    if (Number.isNaN(parsed.getTime())) {\n        return null;\n    }\n    return parsed;\n}\nasync function resolveUser() {\n    const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.createSupabaseServerClient)();\n    const { data: { user }, error } = await supabase.auth.getUser();\n    if (error) {\n        throw new Error(error.message);\n    }\n    if (!user) {\n        return null;\n    }\n    await (0,_lib_ensure_profile__WEBPACK_IMPORTED_MODULE_3__.ensureProfile)(user);\n    return user;\n}\nasync function requireBusiness(userId, businessId) {\n    return _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.business.findFirst({\n        where: {\n            id: businessId,\n            userId\n        }\n    });\n}\nfunction mapDocument(document) {\n    return {\n        id: document.id,\n        businessId: document.businessId,\n        title: document.title,\n        permitNumber: document.permitNumber,\n        documentCategory: document.documentCategory,\n        status: document.status,\n        startDate: document.startDate ? document.startDate.toISOString() : null,\n        endDate: document.endDate ? document.endDate.toISOString() : null,\n        autoRenew: document.autoRenew,\n        createdAt: document.createdAt.toISOString(),\n        updatedAt: document.updatedAt.toISOString(),\n        issuingAuthorityName: document.issuingAuthority?.name ?? null,\n        jurisdictionName: document.jurisdiction?.name ?? null,\n        rawExtractionJson: document.rawExtractionJson ?? null,\n        sourceFileBucket: document.sourceFileBucket,\n        sourceFilePath: document.sourceFilePath,\n        sourceFileContentType: document.sourceFileContentType,\n        sourceFileName: document.sourceFileName,\n        sourceFileSize: document.sourceFileSize\n    };\n}\nclass SourceFilePayloadError extends Error {\n    constructor(message, status = 400){\n        super(message);\n        this.status = status;\n    }\n}\nfunction resolveSourceFileDecision(payload, userId) {\n    const keys = [\n        payload.sourceFileBucket,\n        payload.sourceFilePath,\n        payload.sourceFileContentType,\n        payload.sourceFileName,\n        payload.sourceFileSize\n    ];\n    const provided = keys.some((value)=>value !== undefined);\n    if (!provided) {\n        return {\n            action: \"ignore\"\n        };\n    }\n    const bucket = payload.sourceFileBucket;\n    const path = payload.sourceFilePath;\n    if (bucket === null || bucket === \"\" || path === null || path === \"\") {\n        return {\n            action: \"clear\"\n        };\n    }\n    if (typeof bucket !== \"string\" || typeof path !== \"string\") {\n        throw new SourceFilePayloadError(\"Invalid source file metadata\");\n    }\n    if (bucket !== _lib_storage__WEBPACK_IMPORTED_MODULE_4__.PERMIT_FILES_BUCKET || !path.startsWith(`${userId}/`)) {\n        throw new SourceFilePayloadError(\"Invalid source file reference\");\n    }\n    const contentType = typeof payload.sourceFileContentType === \"string\" && payload.sourceFileContentType.trim().length > 0 ? payload.sourceFileContentType.trim() : \"application/octet-stream\";\n    const name = typeof payload.sourceFileName === \"string\" && payload.sourceFileName.trim().length > 0 ? payload.sourceFileName.trim() : \"permit-file\";\n    const sizeValue = payload.sourceFileSize;\n    const numericSize = typeof sizeValue === \"number\" ? sizeValue : typeof sizeValue === \"string\" && sizeValue.trim().length > 0 ? Number.parseInt(sizeValue, 10) : Number.NaN;\n    if (!Number.isFinite(numericSize)) {\n        throw new SourceFilePayloadError(\"Invalid source file size\");\n    }\n    return {\n        action: \"set\",\n        value: {\n            bucket,\n            path,\n            contentType,\n            name,\n            size: numericSize\n        }\n    };\n}\nasync function findOrCreateJurisdiction(name) {\n    const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.jurisdiction.findFirst({\n        where: {\n            name\n        }\n    });\n    if (existing) {\n        return existing;\n    }\n    return _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.jurisdiction.create({\n        data: {\n            name\n        }\n    });\n}\nasync function findOrCreateIssuingAuthority(name) {\n    const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.issuingAuthority.findFirst({\n        where: {\n            name\n        }\n    });\n    if (existing) {\n        return existing;\n    }\n    return _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.issuingAuthority.create({\n        data: {\n            name\n        }\n    });\n}\nasync function GET(_req, { params }) {\n    const businessId = parseId(params.id);\n    if (!businessId) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"A valid company id is required\"\n        }, {\n            status: 400\n        });\n    }\n    try {\n        const user = await resolveUser();\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const business = await requireBusiness(user.id, businessId);\n        if (!business) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Company not found\"\n            }, {\n                status: 404\n            });\n        }\n        const documents = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.businessDocument.findMany({\n            where: {\n                businessId: business.id\n            },\n            orderBy: [\n                {\n                    createdAt: \"desc\"\n                },\n                {\n                    id: \"desc\"\n                }\n            ],\n            include: {\n                jurisdiction: true,\n                issuingAuthority: true\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(documents.map(mapDocument));\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: resolveErrorMessage(error, \"Failed to load permits\")\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(req, { params }) {\n    const businessId = parseId(params.id);\n    if (!businessId) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"A valid company id is required\"\n        }, {\n            status: 400\n        });\n    }\n    let payload;\n    try {\n        payload = await req.json();\n    } catch  {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Invalid JSON payload\"\n        }, {\n            status: 400\n        });\n    }\n    const title = typeof payload.title === \"string\" ? payload.title.trim() : \"\";\n    if (!title) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Permit title is required\"\n        }, {\n            status: 400\n        });\n    }\n    const jurisdictionName = typeof payload.jurisdictionName === \"string\" ? payload.jurisdictionName.trim() : \"\";\n    const issuingAuthorityName = typeof payload.issuingAuthorityName === \"string\" ? payload.issuingAuthorityName.trim() : \"\";\n    try {\n        const user = await resolveUser();\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const business = await requireBusiness(user.id, businessId);\n        if (!business) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Company not found\"\n            }, {\n                status: 404\n            });\n        }\n        const startDate = parseDate(payload.startDate);\n        const endDate = parseDate(payload.endDate);\n        const sourceFileDecision = resolveSourceFileDecision(payload, user.id);\n        const rawExtraction = payload.rawExtraction === undefined ? undefined : payload.rawExtraction;\n        const [jurisdiction, issuingAuthority] = await Promise.all([\n            jurisdictionName ? findOrCreateJurisdiction(jurisdictionName) : Promise.resolve(null),\n            issuingAuthorityName ? findOrCreateIssuingAuthority(issuingAuthorityName) : Promise.resolve(null)\n        ]);\n        const document = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.businessDocument.create({\n            data: {\n                businessId: business.id,\n                title,\n                permitNumber: typeof payload.permitNumber === \"string\" && payload.permitNumber.trim().length > 0 ? payload.permitNumber.trim() : null,\n                documentCategory: normalizeCategory(payload.documentCategory),\n                status: normalizeStatus(payload.status),\n                startDate,\n                endDate,\n                autoRenew: payload.autoRenew === true,\n                rawExtractionJson: rawExtraction ?? _prisma_client__WEBPACK_IMPORTED_MODULE_5__.Prisma.JsonNull,\n                jurisdictionId: jurisdiction?.id ?? null,\n                issuingAuthorityId: issuingAuthority?.id ?? null,\n                sourceFileBucket: sourceFileDecision.action === \"set\" ? sourceFileDecision.value.bucket : null,\n                sourceFilePath: sourceFileDecision.action === \"set\" ? sourceFileDecision.value.path : null,\n                sourceFileContentType: sourceFileDecision.action === \"set\" ? sourceFileDecision.value.contentType : null,\n                sourceFileName: sourceFileDecision.action === \"set\" ? sourceFileDecision.value.name : null,\n                sourceFileSize: sourceFileDecision.action === \"set\" ? sourceFileDecision.value.size : null\n            },\n            include: {\n                jurisdiction: true,\n                issuingAuthority: true\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(mapDocument(document), {\n            status: 201\n        });\n    } catch (error) {\n        if (error instanceof SourceFilePayloadError) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: error.message\n            }, {\n                status: error.status\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: resolveErrorMessage(error, \"Failed to add permit\")\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2J1c2luZXNzZXMvW2lkXS9kb2N1bWVudHMvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUEyQztBQUNMO0FBQzZCO0FBQ2Q7QUFDcUI7QUFRbEQ7QUFFakIsTUFBTVEsVUFBVSxTQUFTO0FBUWhDLFNBQVNDLG9CQUFvQkMsS0FBYyxFQUFFQyxRQUFnQjtJQUMzRCxJQUFJRCxpQkFBaUJFLFNBQVNGLE1BQU1HLE9BQU8sRUFBRTtRQUMzQyxPQUFPSCxNQUFNRyxPQUFPO0lBQ3RCO0lBQ0EsT0FBT0Y7QUFDVDtBQUVBLFNBQVNHLFFBQVFDLE1BQWM7SUFDN0IsTUFBTUMsUUFBUUMsT0FBT0Y7SUFDckIsSUFBSSxDQUFDRSxPQUFPQyxRQUFRLENBQUNGLFVBQVVBLFNBQVMsR0FBRztRQUN6QyxPQUFPO0lBQ1Q7SUFDQSxPQUFPQTtBQUNUO0FBRUEsU0FBU0csa0JBQWtCSCxLQUFlO0lBQ3hDLElBQUksT0FBT0EsVUFBVSxVQUFVO1FBQzdCLE1BQU1JLGFBQWFKLE1BQU1LLElBQUksR0FBR0MsV0FBVztRQUMzQyxJQUFJQyxPQUFPQyxNQUFNLENBQUNuQiw0REFBZ0JBLEVBQUVvQixRQUFRLENBQUNMLGFBQWlDO1lBQzVFLE9BQU9BO1FBQ1Q7SUFDRjtJQUNBLE9BQU9mLDREQUFnQkEsQ0FBQ3FCLE1BQU07QUFDaEM7QUFFQSxTQUFTQyxnQkFBZ0JYLEtBQWU7SUFDdEMsSUFBSSxPQUFPQSxVQUFVLFVBQVU7UUFDN0IsTUFBTUksYUFBYUosTUFBTUssSUFBSSxHQUFHQyxXQUFXLEdBQUdNLE9BQU8sQ0FBQyxXQUFXO1FBQ2pFLElBQUlMLE9BQU9DLE1BQU0sQ0FBQ2xCLDBEQUFjQSxFQUFFbUIsUUFBUSxDQUFDTCxhQUErQjtZQUN4RSxPQUFPQTtRQUNUO0lBQ0Y7SUFDQSxPQUFPZCwwREFBY0EsQ0FBQ3VCLE1BQU07QUFDOUI7QUFFQSxTQUFTQyxVQUFVZCxLQUFlO0lBQ2hDLElBQUksT0FBT0EsVUFBVSxVQUFVO1FBQzdCLE9BQU87SUFDVDtJQUNBLE1BQU1lLFVBQVVmLE1BQU1LLElBQUk7SUFDMUIsSUFBSSxDQUFDVSxTQUFTO1FBQ1osT0FBTztJQUNUO0lBQ0EsTUFBTUMsU0FBUyxJQUFJQyxLQUFLRjtJQUN4QixJQUFJZCxPQUFPaUIsS0FBSyxDQUFDRixPQUFPRyxPQUFPLEtBQUs7UUFDbEMsT0FBTztJQUNUO0lBQ0EsT0FBT0g7QUFDVDtBQUVBLGVBQWVJO0lBQ2IsTUFBTUMsV0FBV25DLGdGQUEwQkE7SUFDM0MsTUFBTSxFQUNKb0MsTUFBTSxFQUFFQyxJQUFJLEVBQUUsRUFDZDdCLEtBQUssRUFDTixHQUFHLE1BQU0yQixTQUFTRyxJQUFJLENBQUNDLE9BQU87SUFFL0IsSUFBSS9CLE9BQU87UUFDVCxNQUFNLElBQUlFLE1BQU1GLE1BQU1HLE9BQU87SUFDL0I7SUFFQSxJQUFJLENBQUMwQixNQUFNO1FBQ1QsT0FBTztJQUNUO0lBRUEsTUFBTXBDLGtFQUFhQSxDQUFDb0M7SUFDcEIsT0FBT0E7QUFDVDtBQUVBLGVBQWVHLGdCQUFnQkMsTUFBYyxFQUFFQyxVQUFrQjtJQUMvRCxPQUFPM0MsK0NBQU1BLENBQUM0QyxRQUFRLENBQUNDLFNBQVMsQ0FBQztRQUMvQkMsT0FBTztZQUNMQyxJQUFJSjtZQUNKRDtRQUNGO0lBQ0Y7QUFDRjtBQU9BLFNBQVNNLFlBQVlDLFFBQStCO0lBQ2xELE9BQU87UUFDTEYsSUFBSUUsU0FBU0YsRUFBRTtRQUNmSixZQUFZTSxTQUFTTixVQUFVO1FBQy9CTyxPQUFPRCxTQUFTQyxLQUFLO1FBQ3JCQyxjQUFjRixTQUFTRSxZQUFZO1FBQ25DQyxrQkFBa0JILFNBQVNHLGdCQUFnQjtRQUMzQ0MsUUFBUUosU0FBU0ksTUFBTTtRQUN2QkMsV0FBV0wsU0FBU0ssU0FBUyxHQUFHTCxTQUFTSyxTQUFTLENBQUNDLFdBQVcsS0FBSztRQUNuRUMsU0FBU1AsU0FBU08sT0FBTyxHQUFHUCxTQUFTTyxPQUFPLENBQUNELFdBQVcsS0FBSztRQUM3REUsV0FBV1IsU0FBU1EsU0FBUztRQUM3QkMsV0FBV1QsU0FBU1MsU0FBUyxDQUFDSCxXQUFXO1FBQ3pDSSxXQUFXVixTQUFTVSxTQUFTLENBQUNKLFdBQVc7UUFDekNLLHNCQUFzQlgsU0FBU1ksZ0JBQWdCLEVBQUVDLFFBQVE7UUFDekRDLGtCQUFrQmQsU0FBU2UsWUFBWSxFQUFFRixRQUFRO1FBQ2pERyxtQkFBbUJoQixTQUFTZ0IsaUJBQWlCLElBQUk7UUFDakRDLGtCQUFrQmpCLFNBQVNpQixnQkFBZ0I7UUFDM0NDLGdCQUFnQmxCLFNBQVNrQixjQUFjO1FBQ3ZDQyx1QkFBdUJuQixTQUFTbUIscUJBQXFCO1FBQ3JEQyxnQkFBZ0JwQixTQUFTb0IsY0FBYztRQUN2Q0MsZ0JBQWdCckIsU0FBU3FCLGNBQWM7SUFDekM7QUFDRjtBQU9BLE1BQU1DLCtCQUErQjVEO0lBR25DNkQsWUFBWTVELE9BQWUsRUFBRXlDLFNBQVMsR0FBRyxDQUFFO1FBQ3pDLEtBQUssQ0FBQ3pDO1FBQ04sSUFBSSxDQUFDeUMsTUFBTSxHQUFHQTtJQUNoQjtBQUNGO0FBRUEsU0FBU29CLDBCQUEwQkMsT0FBZ0MsRUFBRWhDLE1BQWM7SUFDakYsTUFBTWlDLE9BQU87UUFDWEQsUUFBUVIsZ0JBQWdCO1FBQ3hCUSxRQUFRUCxjQUFjO1FBQ3RCTyxRQUFRTixxQkFBcUI7UUFDN0JNLFFBQVFMLGNBQWM7UUFDdEJLLFFBQVFKLGNBQWM7S0FDdkI7SUFFRCxNQUFNTSxXQUFXRCxLQUFLRSxJQUFJLENBQUMsQ0FBQzlELFFBQVVBLFVBQVUrRDtJQUNoRCxJQUFJLENBQUNGLFVBQVU7UUFDYixPQUFPO1lBQUVHLFFBQVE7UUFBUztJQUM1QjtJQUVBLE1BQU1DLFNBQVNOLFFBQVFSLGdCQUFnQjtJQUN2QyxNQUFNZSxPQUFPUCxRQUFRUCxjQUFjO0lBRW5DLElBQUlhLFdBQVcsUUFBUUEsV0FBVyxNQUFNQyxTQUFTLFFBQVFBLFNBQVMsSUFBSTtRQUNwRSxPQUFPO1lBQUVGLFFBQVE7UUFBUTtJQUMzQjtJQUVBLElBQUksT0FBT0MsV0FBVyxZQUFZLE9BQU9DLFNBQVMsVUFBVTtRQUMxRCxNQUFNLElBQUlWLHVCQUF1QjtJQUNuQztJQUVBLElBQUlTLFdBQVc3RSw2REFBbUJBLElBQUksQ0FBQzhFLEtBQUtDLFVBQVUsQ0FBQyxDQUFDLEVBQUV4QyxPQUFPLENBQUMsQ0FBQyxHQUFHO1FBQ3BFLE1BQU0sSUFBSTZCLHVCQUF1QjtJQUNuQztJQUVBLE1BQU1ZLGNBQ0osT0FBT1QsUUFBUU4scUJBQXFCLEtBQUssWUFBWU0sUUFBUU4scUJBQXFCLENBQUNoRCxJQUFJLEdBQUdnRSxNQUFNLEdBQUcsSUFDL0ZWLFFBQVFOLHFCQUFxQixDQUFDaEQsSUFBSSxLQUNsQztJQUNOLE1BQU0wQyxPQUNKLE9BQU9ZLFFBQVFMLGNBQWMsS0FBSyxZQUFZSyxRQUFRTCxjQUFjLENBQUNqRCxJQUFJLEdBQUdnRSxNQUFNLEdBQUcsSUFDakZWLFFBQVFMLGNBQWMsQ0FBQ2pELElBQUksS0FDM0I7SUFFTixNQUFNaUUsWUFBWVgsUUFBUUosY0FBYztJQUN4QyxNQUFNZ0IsY0FDSixPQUFPRCxjQUFjLFdBQ2pCQSxZQUNBLE9BQU9BLGNBQWMsWUFBWUEsVUFBVWpFLElBQUksR0FBR2dFLE1BQU0sR0FBRyxJQUMzRHBFLE9BQU91RSxRQUFRLENBQUNGLFdBQVcsTUFDM0JyRSxPQUFPd0UsR0FBRztJQUVoQixJQUFJLENBQUN4RSxPQUFPQyxRQUFRLENBQUNxRSxjQUFjO1FBQ2pDLE1BQU0sSUFBSWYsdUJBQXVCO0lBQ25DO0lBRUEsT0FBTztRQUNMUSxRQUFRO1FBQ1JoRSxPQUFPO1lBQ0xpRTtZQUNBQztZQUNBRTtZQUNBckI7WUFDQTJCLE1BQU1IO1FBQ1I7SUFDRjtBQUNGO0FBRUEsZUFBZUkseUJBQXlCNUIsSUFBWTtJQUNsRCxNQUFNNkIsV0FBVyxNQUFNM0YsK0NBQU1BLENBQUNnRSxZQUFZLENBQUNuQixTQUFTLENBQUM7UUFBRUMsT0FBTztZQUFFZ0I7UUFBSztJQUFFO0lBQ3ZFLElBQUk2QixVQUFVO1FBQ1osT0FBT0E7SUFDVDtJQUNBLE9BQU8zRiwrQ0FBTUEsQ0FBQ2dFLFlBQVksQ0FBQzRCLE1BQU0sQ0FBQztRQUFFdkQsTUFBTTtZQUFFeUI7UUFBSztJQUFFO0FBQ3JEO0FBRUEsZUFBZStCLDZCQUE2Qi9CLElBQVk7SUFDdEQsTUFBTTZCLFdBQVcsTUFBTTNGLCtDQUFNQSxDQUFDNkQsZ0JBQWdCLENBQUNoQixTQUFTLENBQUM7UUFBRUMsT0FBTztZQUFFZ0I7UUFBSztJQUFFO0lBQzNFLElBQUk2QixVQUFVO1FBQ1osT0FBT0E7SUFDVDtJQUNBLE9BQU8zRiwrQ0FBTUEsQ0FBQzZELGdCQUFnQixDQUFDK0IsTUFBTSxDQUFDO1FBQUV2RCxNQUFNO1lBQUV5QjtRQUFLO0lBQUU7QUFDekQ7QUFFTyxlQUFlZ0MsSUFBSUMsSUFBYSxFQUFFLEVBQUVDLE1BQU0sRUFBZTtJQUM5RCxNQUFNckQsYUFBYTlCLFFBQVFtRixPQUFPakQsRUFBRTtJQUVwQyxJQUFJLENBQUNKLFlBQVk7UUFDZixPQUFPNUMscURBQVlBLENBQUNrRyxJQUFJLENBQUM7WUFBRXhGLE9BQU87UUFBaUMsR0FBRztZQUFFNEMsUUFBUTtRQUFJO0lBQ3RGO0lBRUEsSUFBSTtRQUNGLE1BQU1mLE9BQU8sTUFBTUg7UUFFbkIsSUFBSSxDQUFDRyxNQUFNO1lBQ1QsT0FBT3ZDLHFEQUFZQSxDQUFDa0csSUFBSSxDQUFDO2dCQUFFeEYsT0FBTztZQUFlLEdBQUc7Z0JBQUU0QyxRQUFRO1lBQUk7UUFDcEU7UUFFQSxNQUFNVCxXQUFXLE1BQU1ILGdCQUFnQkgsS0FBS1MsRUFBRSxFQUFFSjtRQUVoRCxJQUFJLENBQUNDLFVBQVU7WUFDYixPQUFPN0MscURBQVlBLENBQUNrRyxJQUFJLENBQUM7Z0JBQUV4RixPQUFPO1lBQW9CLEdBQUc7Z0JBQUU0QyxRQUFRO1lBQUk7UUFDekU7UUFFQSxNQUFNNkMsWUFBWSxNQUFNbEcsK0NBQU1BLENBQUNtRyxnQkFBZ0IsQ0FBQ0MsUUFBUSxDQUFDO1lBQ3ZEdEQsT0FBTztnQkFBRUgsWUFBWUMsU0FBU0csRUFBRTtZQUFDO1lBQ2pDc0QsU0FBUztnQkFBQztvQkFBRTNDLFdBQVc7Z0JBQU87Z0JBQUc7b0JBQUVYLElBQUk7Z0JBQU87YUFBRTtZQUNoRHVELFNBQVM7Z0JBQ1B0QyxjQUFjO2dCQUNkSCxrQkFBa0I7WUFDcEI7UUFDRjtRQUVBLE9BQU85RCxxREFBWUEsQ0FBQ2tHLElBQUksQ0FBQ0MsVUFBVUssR0FBRyxDQUFDdkQ7SUFDekMsRUFBRSxPQUFPdkMsT0FBZ0I7UUFDdkIsT0FBT1YscURBQVlBLENBQUNrRyxJQUFJLENBQ3RCO1lBQUV4RixPQUFPRCxvQkFBb0JDLE9BQU87UUFBMEIsR0FDOUQ7WUFBRTRDLFFBQVE7UUFBSTtJQUVsQjtBQUNGO0FBRU8sZUFBZW1ELEtBQUtDLEdBQVksRUFBRSxFQUFFVCxNQUFNLEVBQWU7SUFDOUQsTUFBTXJELGFBQWE5QixRQUFRbUYsT0FBT2pELEVBQUU7SUFFcEMsSUFBSSxDQUFDSixZQUFZO1FBQ2YsT0FBTzVDLHFEQUFZQSxDQUFDa0csSUFBSSxDQUFDO1lBQUV4RixPQUFPO1FBQWlDLEdBQUc7WUFBRTRDLFFBQVE7UUFBSTtJQUN0RjtJQUVBLElBQUlxQjtJQUVKLElBQUk7UUFDRkEsVUFBVSxNQUFNK0IsSUFBSVIsSUFBSTtJQUMxQixFQUFFLE9BQU07UUFDTixPQUFPbEcscURBQVlBLENBQUNrRyxJQUFJLENBQUM7WUFBRXhGLE9BQU87UUFBdUIsR0FBRztZQUFFNEMsUUFBUTtRQUFJO0lBQzVFO0lBRUEsTUFBTUgsUUFBUSxPQUFPd0IsUUFBUXhCLEtBQUssS0FBSyxXQUFXd0IsUUFBUXhCLEtBQUssQ0FBQzlCLElBQUksS0FBSztJQUN6RSxJQUFJLENBQUM4QixPQUFPO1FBQ1YsT0FBT25ELHFEQUFZQSxDQUFDa0csSUFBSSxDQUFDO1lBQUV4RixPQUFPO1FBQTJCLEdBQUc7WUFBRTRDLFFBQVE7UUFBSTtJQUNoRjtJQUVBLE1BQU1VLG1CQUNKLE9BQU9XLFFBQVFYLGdCQUFnQixLQUFLLFdBQVdXLFFBQVFYLGdCQUFnQixDQUFDM0MsSUFBSSxLQUFLO0lBQ25GLE1BQU13Qyx1QkFDSixPQUFPYyxRQUFRZCxvQkFBb0IsS0FBSyxXQUFXYyxRQUFRZCxvQkFBb0IsQ0FBQ3hDLElBQUksS0FBSztJQUUzRixJQUFJO1FBQ0YsTUFBTWtCLE9BQU8sTUFBTUg7UUFFbkIsSUFBSSxDQUFDRyxNQUFNO1lBQ1QsT0FBT3ZDLHFEQUFZQSxDQUFDa0csSUFBSSxDQUFDO2dCQUFFeEYsT0FBTztZQUFlLEdBQUc7Z0JBQUU0QyxRQUFRO1lBQUk7UUFDcEU7UUFFQSxNQUFNVCxXQUFXLE1BQU1ILGdCQUFnQkgsS0FBS1MsRUFBRSxFQUFFSjtRQUVoRCxJQUFJLENBQUNDLFVBQVU7WUFDYixPQUFPN0MscURBQVlBLENBQUNrRyxJQUFJLENBQUM7Z0JBQUV4RixPQUFPO1lBQW9CLEdBQUc7Z0JBQUU0QyxRQUFRO1lBQUk7UUFDekU7UUFFQSxNQUFNQyxZQUFZekIsVUFBVTZDLFFBQVFwQixTQUFTO1FBQzdDLE1BQU1FLFVBQVUzQixVQUFVNkMsUUFBUWxCLE9BQU87UUFDekMsTUFBTWtELHFCQUFxQmpDLDBCQUEwQkMsU0FBU3BDLEtBQUtTLEVBQUU7UUFDckUsTUFBTTRELGdCQUNKakMsUUFBUWlDLGFBQWEsS0FBSzdCLFlBQ3RCQSxZQUNDSixRQUFRaUMsYUFBYTtRQUU1QixNQUFNLENBQUMzQyxjQUFjSCxpQkFBaUIsR0FBRyxNQUFNK0MsUUFBUUMsR0FBRyxDQUFDO1lBQ3pEOUMsbUJBQW1CMkIseUJBQXlCM0Isb0JBQW9CNkMsUUFBUUUsT0FBTyxDQUFDO1lBQ2hGbEQsdUJBQXVCaUMsNkJBQTZCakMsd0JBQXdCZ0QsUUFBUUUsT0FBTyxDQUFDO1NBQzdGO1FBRUQsTUFBTTdELFdBQVcsTUFBTWpELCtDQUFNQSxDQUFDbUcsZ0JBQWdCLENBQUNQLE1BQU0sQ0FBQztZQUNwRHZELE1BQU07Z0JBQ0pNLFlBQVlDLFNBQVNHLEVBQUU7Z0JBQ3ZCRztnQkFDQUMsY0FDRSxPQUFPdUIsUUFBUXZCLFlBQVksS0FBSyxZQUFZdUIsUUFBUXZCLFlBQVksQ0FBQy9CLElBQUksR0FBR2dFLE1BQU0sR0FBRyxJQUM3RVYsUUFBUXZCLFlBQVksQ0FBQy9CLElBQUksS0FDekI7Z0JBQ05nQyxrQkFBa0JsQyxrQkFBa0J3RCxRQUFRdEIsZ0JBQWdCO2dCQUM1REMsUUFBUTNCLGdCQUFnQmdELFFBQVFyQixNQUFNO2dCQUN0Q0M7Z0JBQ0FFO2dCQUNBQyxXQUFXaUIsUUFBUWpCLFNBQVMsS0FBSztnQkFDakNRLG1CQUFtQjBDLGlCQUFpQnJHLGtEQUFNQSxDQUFDeUcsUUFBUTtnQkFDbkRDLGdCQUFnQmhELGNBQWNqQixNQUFNO2dCQUNwQ2tFLG9CQUFvQnBELGtCQUFrQmQsTUFBTTtnQkFDNUNtQixrQkFBa0J3QyxtQkFBbUIzQixNQUFNLEtBQUssUUFBUTJCLG1CQUFtQjNGLEtBQUssQ0FBQ2lFLE1BQU0sR0FBRztnQkFDMUZiLGdCQUFnQnVDLG1CQUFtQjNCLE1BQU0sS0FBSyxRQUFRMkIsbUJBQW1CM0YsS0FBSyxDQUFDa0UsSUFBSSxHQUFHO2dCQUN0RmIsdUJBQ0VzQyxtQkFBbUIzQixNQUFNLEtBQUssUUFBUTJCLG1CQUFtQjNGLEtBQUssQ0FBQ29FLFdBQVcsR0FBRztnQkFDL0VkLGdCQUNFcUMsbUJBQW1CM0IsTUFBTSxLQUFLLFFBQVEyQixtQkFBbUIzRixLQUFLLENBQUMrQyxJQUFJLEdBQUc7Z0JBQ3hFUSxnQkFBZ0JvQyxtQkFBbUIzQixNQUFNLEtBQUssUUFBUTJCLG1CQUFtQjNGLEtBQUssQ0FBQzBFLElBQUksR0FBRztZQUN4RjtZQUNBYSxTQUFTO2dCQUNQdEMsY0FBYztnQkFDZEgsa0JBQWtCO1lBQ3BCO1FBQ0Y7UUFFQSxPQUFPOUQscURBQVlBLENBQUNrRyxJQUFJLENBQUNqRCxZQUFZQyxXQUFXO1lBQUVJLFFBQVE7UUFBSTtJQUNoRSxFQUFFLE9BQU81QyxPQUFnQjtRQUN2QixJQUFJQSxpQkFBaUI4RCx3QkFBd0I7WUFDM0MsT0FBT3hFLHFEQUFZQSxDQUFDa0csSUFBSSxDQUFDO2dCQUFFeEYsT0FBT0EsTUFBTUcsT0FBTztZQUFDLEdBQUc7Z0JBQUV5QyxRQUFRNUMsTUFBTTRDLE1BQU07WUFBQztRQUM1RTtRQUNBLE9BQU90RCxxREFBWUEsQ0FBQ2tHLElBQUksQ0FDdEI7WUFBRXhGLE9BQU9ELG9CQUFvQkMsT0FBTztRQUF3QixHQUM1RDtZQUFFNEMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvYXBpL2J1c2luZXNzZXMvW2lkXS9kb2N1bWVudHMvcm91dGUudHM/ZDYyZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcbmltcG9ydCB7IGNyZWF0ZVN1cGFiYXNlU2VydmVyQ2xpZW50IH0gZnJvbSBcIkAvbGliL3N1cGFiYXNlL3NlcnZlclwiO1xuaW1wb3J0IHsgZW5zdXJlUHJvZmlsZSB9IGZyb20gXCJAL2xpYi9lbnN1cmUtcHJvZmlsZVwiO1xuaW1wb3J0IHsgUEVSTUlUX0ZJTEVTX0JVQ0tFVCwgUGVybWl0U291cmNlRmlsZU1ldGEgfSBmcm9tIFwiQC9saWIvc3RvcmFnZVwiO1xuaW1wb3J0IHtcbiAgQnVzaW5lc3NEb2N1bWVudCxcbiAgRG9jdW1lbnRDYXRlZ29yeSxcbiAgRG9jdW1lbnRTdGF0dXMsXG4gIElzc3VpbmdBdXRob3JpdHksXG4gIEp1cmlzZGljdGlvbixcbiAgUHJpc21hLFxufSBmcm9tIFwiQHByaXNtYS9jbGllbnRcIjtcblxuZXhwb3J0IGNvbnN0IHJ1bnRpbWUgPSBcIm5vZGVqc1wiO1xuXG50eXBlIFJvdXRlUGFyYW1zID0ge1xuICBwYXJhbXM6IHtcbiAgICBpZDogc3RyaW5nO1xuICB9O1xufTtcblxuZnVuY3Rpb24gcmVzb2x2ZUVycm9yTWVzc2FnZShlcnJvcjogdW5rbm93biwgZmFsbGJhY2s6IHN0cmluZykge1xuICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlKSB7XG4gICAgcmV0dXJuIGVycm9yLm1lc3NhZ2U7XG4gIH1cbiAgcmV0dXJuIGZhbGxiYWNrO1xufVxuXG5mdW5jdGlvbiBwYXJzZUlkKHNvdXJjZTogc3RyaW5nKTogbnVtYmVyIHwgbnVsbCB7XG4gIGNvbnN0IHZhbHVlID0gTnVtYmVyKHNvdXJjZSk7XG4gIGlmICghTnVtYmVyLmlzRmluaXRlKHZhbHVlKSB8fCB2YWx1ZSA8PSAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG5mdW5jdGlvbiBub3JtYWxpemVDYXRlZ29yeSh2YWx1ZT86IHVua25vd24pOiBEb2N1bWVudENhdGVnb3J5IHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSB2YWx1ZS50cmltKCkudG9VcHBlckNhc2UoKTtcbiAgICBpZiAoT2JqZWN0LnZhbHVlcyhEb2N1bWVudENhdGVnb3J5KS5pbmNsdWRlcyhub3JtYWxpemVkIGFzIERvY3VtZW50Q2F0ZWdvcnkpKSB7XG4gICAgICByZXR1cm4gbm9ybWFsaXplZCBhcyBEb2N1bWVudENhdGVnb3J5O1xuICAgIH1cbiAgfVxuICByZXR1cm4gRG9jdW1lbnRDYXRlZ29yeS5QRVJNSVQ7XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZVN0YXR1cyh2YWx1ZT86IHVua25vd24pOiBEb2N1bWVudFN0YXR1cyB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICBjb25zdCBub3JtYWxpemVkID0gdmFsdWUudHJpbSgpLnRvVXBwZXJDYXNlKCkucmVwbGFjZSgvW1xccy1dKy9nLCBcIl9cIik7XG4gICAgaWYgKE9iamVjdC52YWx1ZXMoRG9jdW1lbnRTdGF0dXMpLmluY2x1ZGVzKG5vcm1hbGl6ZWQgYXMgRG9jdW1lbnRTdGF0dXMpKSB7XG4gICAgICByZXR1cm4gbm9ybWFsaXplZCBhcyBEb2N1bWVudFN0YXR1cztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIERvY3VtZW50U3RhdHVzLkFDVElWRTtcbn1cblxuZnVuY3Rpb24gcGFyc2VEYXRlKHZhbHVlPzogdW5rbm93bik6IERhdGUgfCBudWxsIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHRyaW1tZWQgPSB2YWx1ZS50cmltKCk7XG4gIGlmICghdHJpbW1lZCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHBhcnNlZCA9IG5ldyBEYXRlKHRyaW1tZWQpO1xuICBpZiAoTnVtYmVyLmlzTmFOKHBhcnNlZC5nZXRUaW1lKCkpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIHBhcnNlZDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcmVzb2x2ZVVzZXIoKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXJDbGllbnQoKTtcbiAgY29uc3Qge1xuICAgIGRhdGE6IHsgdXNlciB9LFxuICAgIGVycm9yLFxuICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XG5cbiAgaWYgKGVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGVycm9yLm1lc3NhZ2UpO1xuICB9XG5cbiAgaWYgKCF1c2VyKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBhd2FpdCBlbnN1cmVQcm9maWxlKHVzZXIpO1xuICByZXR1cm4gdXNlcjtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcmVxdWlyZUJ1c2luZXNzKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBudW1iZXIpIHtcbiAgcmV0dXJuIHByaXNtYS5idXNpbmVzcy5maW5kRmlyc3Qoe1xuICAgIHdoZXJlOiB7XG4gICAgICBpZDogYnVzaW5lc3NJZCxcbiAgICAgIHVzZXJJZCxcbiAgICB9LFxuICB9KTtcbn1cblxudHlwZSBEb2N1bWVudFdpdGhSZWxhdGlvbnMgPSBCdXNpbmVzc0RvY3VtZW50ICYge1xuICBqdXJpc2RpY3Rpb246IEp1cmlzZGljdGlvbiB8IG51bGw7XG4gIGlzc3VpbmdBdXRob3JpdHk6IElzc3VpbmdBdXRob3JpdHkgfCBudWxsO1xufTtcblxuZnVuY3Rpb24gbWFwRG9jdW1lbnQoZG9jdW1lbnQ6IERvY3VtZW50V2l0aFJlbGF0aW9ucykge1xuICByZXR1cm4ge1xuICAgIGlkOiBkb2N1bWVudC5pZCxcbiAgICBidXNpbmVzc0lkOiBkb2N1bWVudC5idXNpbmVzc0lkLFxuICAgIHRpdGxlOiBkb2N1bWVudC50aXRsZSxcbiAgICBwZXJtaXROdW1iZXI6IGRvY3VtZW50LnBlcm1pdE51bWJlcixcbiAgICBkb2N1bWVudENhdGVnb3J5OiBkb2N1bWVudC5kb2N1bWVudENhdGVnb3J5LFxuICAgIHN0YXR1czogZG9jdW1lbnQuc3RhdHVzLFxuICAgIHN0YXJ0RGF0ZTogZG9jdW1lbnQuc3RhcnREYXRlID8gZG9jdW1lbnQuc3RhcnREYXRlLnRvSVNPU3RyaW5nKCkgOiBudWxsLFxuICAgIGVuZERhdGU6IGRvY3VtZW50LmVuZERhdGUgPyBkb2N1bWVudC5lbmREYXRlLnRvSVNPU3RyaW5nKCkgOiBudWxsLFxuICAgIGF1dG9SZW5ldzogZG9jdW1lbnQuYXV0b1JlbmV3LFxuICAgIGNyZWF0ZWRBdDogZG9jdW1lbnQuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXG4gICAgdXBkYXRlZEF0OiBkb2N1bWVudC51cGRhdGVkQXQudG9JU09TdHJpbmcoKSxcbiAgICBpc3N1aW5nQXV0aG9yaXR5TmFtZTogZG9jdW1lbnQuaXNzdWluZ0F1dGhvcml0eT8ubmFtZSA/PyBudWxsLFxuICAgIGp1cmlzZGljdGlvbk5hbWU6IGRvY3VtZW50Lmp1cmlzZGljdGlvbj8ubmFtZSA/PyBudWxsLFxuICAgIHJhd0V4dHJhY3Rpb25Kc29uOiBkb2N1bWVudC5yYXdFeHRyYWN0aW9uSnNvbiA/PyBudWxsLFxuICAgIHNvdXJjZUZpbGVCdWNrZXQ6IGRvY3VtZW50LnNvdXJjZUZpbGVCdWNrZXQsXG4gICAgc291cmNlRmlsZVBhdGg6IGRvY3VtZW50LnNvdXJjZUZpbGVQYXRoLFxuICAgIHNvdXJjZUZpbGVDb250ZW50VHlwZTogZG9jdW1lbnQuc291cmNlRmlsZUNvbnRlbnRUeXBlLFxuICAgIHNvdXJjZUZpbGVOYW1lOiBkb2N1bWVudC5zb3VyY2VGaWxlTmFtZSxcbiAgICBzb3VyY2VGaWxlU2l6ZTogZG9jdW1lbnQuc291cmNlRmlsZVNpemUsXG4gIH07XG59XG5cbnR5cGUgU291cmNlRmlsZURlY2lzaW9uID1cbiAgfCB7IGFjdGlvbjogXCJpZ25vcmVcIiB9XG4gIHwgeyBhY3Rpb246IFwiY2xlYXJcIiB9XG4gIHwgeyBhY3Rpb246IFwic2V0XCI7IHZhbHVlOiBQZXJtaXRTb3VyY2VGaWxlTWV0YSB9O1xuXG5jbGFzcyBTb3VyY2VGaWxlUGF5bG9hZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBzdGF0dXM6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIHN0YXR1cyA9IDQwMCkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlc29sdmVTb3VyY2VGaWxlRGVjaXNpb24ocGF5bG9hZDogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHVzZXJJZDogc3RyaW5nKTogU291cmNlRmlsZURlY2lzaW9uIHtcbiAgY29uc3Qga2V5cyA9IFtcbiAgICBwYXlsb2FkLnNvdXJjZUZpbGVCdWNrZXQsXG4gICAgcGF5bG9hZC5zb3VyY2VGaWxlUGF0aCxcbiAgICBwYXlsb2FkLnNvdXJjZUZpbGVDb250ZW50VHlwZSxcbiAgICBwYXlsb2FkLnNvdXJjZUZpbGVOYW1lLFxuICAgIHBheWxvYWQuc291cmNlRmlsZVNpemUsXG4gIF07XG5cbiAgY29uc3QgcHJvdmlkZWQgPSBrZXlzLnNvbWUoKHZhbHVlKSA9PiB2YWx1ZSAhPT0gdW5kZWZpbmVkKTtcbiAgaWYgKCFwcm92aWRlZCkge1xuICAgIHJldHVybiB7IGFjdGlvbjogXCJpZ25vcmVcIiB9O1xuICB9XG5cbiAgY29uc3QgYnVja2V0ID0gcGF5bG9hZC5zb3VyY2VGaWxlQnVja2V0O1xuICBjb25zdCBwYXRoID0gcGF5bG9hZC5zb3VyY2VGaWxlUGF0aDtcblxuICBpZiAoYnVja2V0ID09PSBudWxsIHx8IGJ1Y2tldCA9PT0gXCJcIiB8fCBwYXRoID09PSBudWxsIHx8IHBhdGggPT09IFwiXCIpIHtcbiAgICByZXR1cm4geyBhY3Rpb246IFwiY2xlYXJcIiB9O1xuICB9XG5cbiAgaWYgKHR5cGVvZiBidWNrZXQgIT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIHBhdGggIT09IFwic3RyaW5nXCIpIHtcbiAgICB0aHJvdyBuZXcgU291cmNlRmlsZVBheWxvYWRFcnJvcihcIkludmFsaWQgc291cmNlIGZpbGUgbWV0YWRhdGFcIik7XG4gIH1cblxuICBpZiAoYnVja2V0ICE9PSBQRVJNSVRfRklMRVNfQlVDS0VUIHx8ICFwYXRoLnN0YXJ0c1dpdGgoYCR7dXNlcklkfS9gKSkge1xuICAgIHRocm93IG5ldyBTb3VyY2VGaWxlUGF5bG9hZEVycm9yKFwiSW52YWxpZCBzb3VyY2UgZmlsZSByZWZlcmVuY2VcIik7XG4gIH1cblxuICBjb25zdCBjb250ZW50VHlwZSA9XG4gICAgdHlwZW9mIHBheWxvYWQuc291cmNlRmlsZUNvbnRlbnRUeXBlID09PSBcInN0cmluZ1wiICYmIHBheWxvYWQuc291cmNlRmlsZUNvbnRlbnRUeXBlLnRyaW0oKS5sZW5ndGggPiAwXG4gICAgICA/IHBheWxvYWQuc291cmNlRmlsZUNvbnRlbnRUeXBlLnRyaW0oKVxuICAgICAgOiBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiO1xuICBjb25zdCBuYW1lID1cbiAgICB0eXBlb2YgcGF5bG9hZC5zb3VyY2VGaWxlTmFtZSA9PT0gXCJzdHJpbmdcIiAmJiBwYXlsb2FkLnNvdXJjZUZpbGVOYW1lLnRyaW0oKS5sZW5ndGggPiAwXG4gICAgICA/IHBheWxvYWQuc291cmNlRmlsZU5hbWUudHJpbSgpXG4gICAgICA6IFwicGVybWl0LWZpbGVcIjtcblxuICBjb25zdCBzaXplVmFsdWUgPSBwYXlsb2FkLnNvdXJjZUZpbGVTaXplO1xuICBjb25zdCBudW1lcmljU2l6ZSA9XG4gICAgdHlwZW9mIHNpemVWYWx1ZSA9PT0gXCJudW1iZXJcIlxuICAgICAgPyBzaXplVmFsdWVcbiAgICAgIDogdHlwZW9mIHNpemVWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiBzaXplVmFsdWUudHJpbSgpLmxlbmd0aCA+IDBcbiAgICAgID8gTnVtYmVyLnBhcnNlSW50KHNpemVWYWx1ZSwgMTApXG4gICAgICA6IE51bWJlci5OYU47XG5cbiAgaWYgKCFOdW1iZXIuaXNGaW5pdGUobnVtZXJpY1NpemUpKSB7XG4gICAgdGhyb3cgbmV3IFNvdXJjZUZpbGVQYXlsb2FkRXJyb3IoXCJJbnZhbGlkIHNvdXJjZSBmaWxlIHNpemVcIik7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFjdGlvbjogXCJzZXRcIixcbiAgICB2YWx1ZToge1xuICAgICAgYnVja2V0LFxuICAgICAgcGF0aCxcbiAgICAgIGNvbnRlbnRUeXBlLFxuICAgICAgbmFtZSxcbiAgICAgIHNpemU6IG51bWVyaWNTaXplLFxuICAgIH0sXG4gIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZpbmRPckNyZWF0ZUp1cmlzZGljdGlvbihuYW1lOiBzdHJpbmcpIHtcbiAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCBwcmlzbWEuanVyaXNkaWN0aW9uLmZpbmRGaXJzdCh7IHdoZXJlOiB7IG5hbWUgfSB9KTtcbiAgaWYgKGV4aXN0aW5nKSB7XG4gICAgcmV0dXJuIGV4aXN0aW5nO1xuICB9XG4gIHJldHVybiBwcmlzbWEuanVyaXNkaWN0aW9uLmNyZWF0ZSh7IGRhdGE6IHsgbmFtZSB9IH0pO1xufVxuXG5hc3luYyBmdW5jdGlvbiBmaW5kT3JDcmVhdGVJc3N1aW5nQXV0aG9yaXR5KG5hbWU6IHN0cmluZykge1xuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHByaXNtYS5pc3N1aW5nQXV0aG9yaXR5LmZpbmRGaXJzdCh7IHdoZXJlOiB7IG5hbWUgfSB9KTtcbiAgaWYgKGV4aXN0aW5nKSB7XG4gICAgcmV0dXJuIGV4aXN0aW5nO1xuICB9XG4gIHJldHVybiBwcmlzbWEuaXNzdWluZ0F1dGhvcml0eS5jcmVhdGUoeyBkYXRhOiB7IG5hbWUgfSB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChfcmVxOiBSZXF1ZXN0LCB7IHBhcmFtcyB9OiBSb3V0ZVBhcmFtcykge1xuICBjb25zdCBidXNpbmVzc0lkID0gcGFyc2VJZChwYXJhbXMuaWQpO1xuXG4gIGlmICghYnVzaW5lc3NJZCkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkEgdmFsaWQgY29tcGFueSBpZCBpcyByZXF1aXJlZFwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCByZXNvbHZlVXNlcigpO1xuXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGJ1c2luZXNzID0gYXdhaXQgcmVxdWlyZUJ1c2luZXNzKHVzZXIuaWQsIGJ1c2luZXNzSWQpO1xuXG4gICAgaWYgKCFidXNpbmVzcykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiQ29tcGFueSBub3QgZm91bmRcIiB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGRvY3VtZW50cyA9IGF3YWl0IHByaXNtYS5idXNpbmVzc0RvY3VtZW50LmZpbmRNYW55KHtcbiAgICAgIHdoZXJlOiB7IGJ1c2luZXNzSWQ6IGJ1c2luZXNzLmlkIH0sXG4gICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6IFwiZGVzY1wiIH0sIHsgaWQ6IFwiZGVzY1wiIH1dLFxuICAgICAgaW5jbHVkZToge1xuICAgICAgICBqdXJpc2RpY3Rpb246IHRydWUsXG4gICAgICAgIGlzc3VpbmdBdXRob3JpdHk6IHRydWUsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGRvY3VtZW50cy5tYXAobWFwRG9jdW1lbnQpKTtcbiAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiByZXNvbHZlRXJyb3JNZXNzYWdlKGVycm9yLCBcIkZhaWxlZCB0byBsb2FkIHBlcm1pdHNcIikgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBSZXF1ZXN0LCB7IHBhcmFtcyB9OiBSb3V0ZVBhcmFtcykge1xuICBjb25zdCBidXNpbmVzc0lkID0gcGFyc2VJZChwYXJhbXMuaWQpO1xuXG4gIGlmICghYnVzaW5lc3NJZCkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkEgdmFsaWQgY29tcGFueSBpZCBpcyByZXF1aXJlZFwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gIH1cblxuICBsZXQgcGF5bG9hZDogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG5cbiAgdHJ5IHtcbiAgICBwYXlsb2FkID0gYXdhaXQgcmVxLmpzb24oKTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiSW52YWxpZCBKU09OIHBheWxvYWRcIiB9LCB7IHN0YXR1czogNDAwIH0pO1xuICB9XG5cbiAgY29uc3QgdGl0bGUgPSB0eXBlb2YgcGF5bG9hZC50aXRsZSA9PT0gXCJzdHJpbmdcIiA/IHBheWxvYWQudGl0bGUudHJpbSgpIDogXCJcIjtcbiAgaWYgKCF0aXRsZSkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlBlcm1pdCB0aXRsZSBpcyByZXF1aXJlZFwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gIH1cblxuICBjb25zdCBqdXJpc2RpY3Rpb25OYW1lID1cbiAgICB0eXBlb2YgcGF5bG9hZC5qdXJpc2RpY3Rpb25OYW1lID09PSBcInN0cmluZ1wiID8gcGF5bG9hZC5qdXJpc2RpY3Rpb25OYW1lLnRyaW0oKSA6IFwiXCI7XG4gIGNvbnN0IGlzc3VpbmdBdXRob3JpdHlOYW1lID1cbiAgICB0eXBlb2YgcGF5bG9hZC5pc3N1aW5nQXV0aG9yaXR5TmFtZSA9PT0gXCJzdHJpbmdcIiA/IHBheWxvYWQuaXNzdWluZ0F1dGhvcml0eU5hbWUudHJpbSgpIDogXCJcIjtcblxuICB0cnkge1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCByZXNvbHZlVXNlcigpO1xuXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGJ1c2luZXNzID0gYXdhaXQgcmVxdWlyZUJ1c2luZXNzKHVzZXIuaWQsIGJ1c2luZXNzSWQpO1xuXG4gICAgaWYgKCFidXNpbmVzcykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiQ29tcGFueSBub3QgZm91bmRcIiB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IHBhcnNlRGF0ZShwYXlsb2FkLnN0YXJ0RGF0ZSk7XG4gICAgY29uc3QgZW5kRGF0ZSA9IHBhcnNlRGF0ZShwYXlsb2FkLmVuZERhdGUpO1xuICAgIGNvbnN0IHNvdXJjZUZpbGVEZWNpc2lvbiA9IHJlc29sdmVTb3VyY2VGaWxlRGVjaXNpb24ocGF5bG9hZCwgdXNlci5pZCk7XG4gICAgY29uc3QgcmF3RXh0cmFjdGlvbjogUHJpc21hLklucHV0SnNvblZhbHVlIHwgdW5kZWZpbmVkID1cbiAgICAgIHBheWxvYWQucmF3RXh0cmFjdGlvbiA9PT0gdW5kZWZpbmVkXG4gICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgIDogKHBheWxvYWQucmF3RXh0cmFjdGlvbiBhcyBQcmlzbWEuSW5wdXRKc29uVmFsdWUpO1xuXG4gICAgY29uc3QgW2p1cmlzZGljdGlvbiwgaXNzdWluZ0F1dGhvcml0eV0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICBqdXJpc2RpY3Rpb25OYW1lID8gZmluZE9yQ3JlYXRlSnVyaXNkaWN0aW9uKGp1cmlzZGljdGlvbk5hbWUpIDogUHJvbWlzZS5yZXNvbHZlKG51bGwpLFxuICAgICAgaXNzdWluZ0F1dGhvcml0eU5hbWUgPyBmaW5kT3JDcmVhdGVJc3N1aW5nQXV0aG9yaXR5KGlzc3VpbmdBdXRob3JpdHlOYW1lKSA6IFByb21pc2UucmVzb2x2ZShudWxsKSxcbiAgICBdKTtcblxuICAgIGNvbnN0IGRvY3VtZW50ID0gYXdhaXQgcHJpc21hLmJ1c2luZXNzRG9jdW1lbnQuY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgYnVzaW5lc3NJZDogYnVzaW5lc3MuaWQsXG4gICAgICAgIHRpdGxlLFxuICAgICAgICBwZXJtaXROdW1iZXI6XG4gICAgICAgICAgdHlwZW9mIHBheWxvYWQucGVybWl0TnVtYmVyID09PSBcInN0cmluZ1wiICYmIHBheWxvYWQucGVybWl0TnVtYmVyLnRyaW0oKS5sZW5ndGggPiAwXG4gICAgICAgICAgICA/IHBheWxvYWQucGVybWl0TnVtYmVyLnRyaW0oKVxuICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICBkb2N1bWVudENhdGVnb3J5OiBub3JtYWxpemVDYXRlZ29yeShwYXlsb2FkLmRvY3VtZW50Q2F0ZWdvcnkpLFxuICAgICAgICBzdGF0dXM6IG5vcm1hbGl6ZVN0YXR1cyhwYXlsb2FkLnN0YXR1cyksXG4gICAgICAgIHN0YXJ0RGF0ZSxcbiAgICAgICAgZW5kRGF0ZSxcbiAgICAgICAgYXV0b1JlbmV3OiBwYXlsb2FkLmF1dG9SZW5ldyA9PT0gdHJ1ZSxcbiAgICAgICAgcmF3RXh0cmFjdGlvbkpzb246IHJhd0V4dHJhY3Rpb24gPz8gUHJpc21hLkpzb25OdWxsLFxuICAgICAgICBqdXJpc2RpY3Rpb25JZDoganVyaXNkaWN0aW9uPy5pZCA/PyBudWxsLFxuICAgICAgICBpc3N1aW5nQXV0aG9yaXR5SWQ6IGlzc3VpbmdBdXRob3JpdHk/LmlkID8/IG51bGwsXG4gICAgICAgIHNvdXJjZUZpbGVCdWNrZXQ6IHNvdXJjZUZpbGVEZWNpc2lvbi5hY3Rpb24gPT09IFwic2V0XCIgPyBzb3VyY2VGaWxlRGVjaXNpb24udmFsdWUuYnVja2V0IDogbnVsbCxcbiAgICAgICAgc291cmNlRmlsZVBhdGg6IHNvdXJjZUZpbGVEZWNpc2lvbi5hY3Rpb24gPT09IFwic2V0XCIgPyBzb3VyY2VGaWxlRGVjaXNpb24udmFsdWUucGF0aCA6IG51bGwsXG4gICAgICAgIHNvdXJjZUZpbGVDb250ZW50VHlwZTpcbiAgICAgICAgICBzb3VyY2VGaWxlRGVjaXNpb24uYWN0aW9uID09PSBcInNldFwiID8gc291cmNlRmlsZURlY2lzaW9uLnZhbHVlLmNvbnRlbnRUeXBlIDogbnVsbCxcbiAgICAgICAgc291cmNlRmlsZU5hbWU6XG4gICAgICAgICAgc291cmNlRmlsZURlY2lzaW9uLmFjdGlvbiA9PT0gXCJzZXRcIiA/IHNvdXJjZUZpbGVEZWNpc2lvbi52YWx1ZS5uYW1lIDogbnVsbCxcbiAgICAgICAgc291cmNlRmlsZVNpemU6IHNvdXJjZUZpbGVEZWNpc2lvbi5hY3Rpb24gPT09IFwic2V0XCIgPyBzb3VyY2VGaWxlRGVjaXNpb24udmFsdWUuc2l6ZSA6IG51bGwsXG4gICAgICB9LFxuICAgICAgaW5jbHVkZToge1xuICAgICAgICBqdXJpc2RpY3Rpb246IHRydWUsXG4gICAgICAgIGlzc3VpbmdBdXRob3JpdHk6IHRydWUsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKG1hcERvY3VtZW50KGRvY3VtZW50KSwgeyBzdGF0dXM6IDIwMSB9KTtcbiAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBTb3VyY2VGaWxlUGF5bG9hZEVycm9yKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogZXJyb3Iuc3RhdHVzIH0pO1xuICAgIH1cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiByZXNvbHZlRXJyb3JNZXNzYWdlKGVycm9yLCBcIkZhaWxlZCB0byBhZGQgcGVybWl0XCIpIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicHJpc21hIiwiY3JlYXRlU3VwYWJhc2VTZXJ2ZXJDbGllbnQiLCJlbnN1cmVQcm9maWxlIiwiUEVSTUlUX0ZJTEVTX0JVQ0tFVCIsIkRvY3VtZW50Q2F0ZWdvcnkiLCJEb2N1bWVudFN0YXR1cyIsIlByaXNtYSIsInJ1bnRpbWUiLCJyZXNvbHZlRXJyb3JNZXNzYWdlIiwiZXJyb3IiLCJmYWxsYmFjayIsIkVycm9yIiwibWVzc2FnZSIsInBhcnNlSWQiLCJzb3VyY2UiLCJ2YWx1ZSIsIk51bWJlciIsImlzRmluaXRlIiwibm9ybWFsaXplQ2F0ZWdvcnkiLCJub3JtYWxpemVkIiwidHJpbSIsInRvVXBwZXJDYXNlIiwiT2JqZWN0IiwidmFsdWVzIiwiaW5jbHVkZXMiLCJQRVJNSVQiLCJub3JtYWxpemVTdGF0dXMiLCJyZXBsYWNlIiwiQUNUSVZFIiwicGFyc2VEYXRlIiwidHJpbW1lZCIsInBhcnNlZCIsIkRhdGUiLCJpc05hTiIsImdldFRpbWUiLCJyZXNvbHZlVXNlciIsInN1cGFiYXNlIiwiZGF0YSIsInVzZXIiLCJhdXRoIiwiZ2V0VXNlciIsInJlcXVpcmVCdXNpbmVzcyIsInVzZXJJZCIsImJ1c2luZXNzSWQiLCJidXNpbmVzcyIsImZpbmRGaXJzdCIsIndoZXJlIiwiaWQiLCJtYXBEb2N1bWVudCIsImRvY3VtZW50IiwidGl0bGUiLCJwZXJtaXROdW1iZXIiLCJkb2N1bWVudENhdGVnb3J5Iiwic3RhdHVzIiwic3RhcnREYXRlIiwidG9JU09TdHJpbmciLCJlbmREYXRlIiwiYXV0b1JlbmV3IiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwiaXNzdWluZ0F1dGhvcml0eU5hbWUiLCJpc3N1aW5nQXV0aG9yaXR5IiwibmFtZSIsImp1cmlzZGljdGlvbk5hbWUiLCJqdXJpc2RpY3Rpb24iLCJyYXdFeHRyYWN0aW9uSnNvbiIsInNvdXJjZUZpbGVCdWNrZXQiLCJzb3VyY2VGaWxlUGF0aCIsInNvdXJjZUZpbGVDb250ZW50VHlwZSIsInNvdXJjZUZpbGVOYW1lIiwic291cmNlRmlsZVNpemUiLCJTb3VyY2VGaWxlUGF5bG9hZEVycm9yIiwiY29uc3RydWN0b3IiLCJyZXNvbHZlU291cmNlRmlsZURlY2lzaW9uIiwicGF5bG9hZCIsImtleXMiLCJwcm92aWRlZCIsInNvbWUiLCJ1bmRlZmluZWQiLCJhY3Rpb24iLCJidWNrZXQiLCJwYXRoIiwic3RhcnRzV2l0aCIsImNvbnRlbnRUeXBlIiwibGVuZ3RoIiwic2l6ZVZhbHVlIiwibnVtZXJpY1NpemUiLCJwYXJzZUludCIsIk5hTiIsInNpemUiLCJmaW5kT3JDcmVhdGVKdXJpc2RpY3Rpb24iLCJleGlzdGluZyIsImNyZWF0ZSIsImZpbmRPckNyZWF0ZUlzc3VpbmdBdXRob3JpdHkiLCJHRVQiLCJfcmVxIiwicGFyYW1zIiwianNvbiIsImRvY3VtZW50cyIsImJ1c2luZXNzRG9jdW1lbnQiLCJmaW5kTWFueSIsIm9yZGVyQnkiLCJpbmNsdWRlIiwibWFwIiwiUE9TVCIsInJlcSIsInNvdXJjZUZpbGVEZWNpc2lvbiIsInJhd0V4dHJhY3Rpb24iLCJQcm9taXNlIiwiYWxsIiwicmVzb2x2ZSIsIkpzb25OdWxsIiwianVyaXNkaWN0aW9uSWQiLCJpc3N1aW5nQXV0aG9yaXR5SWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/businesses/[id]/documents/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ensure-profile.ts":
/*!*******************************!*\
  !*** ./lib/ensure-profile.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ensureProfile: () => (/* binding */ ensureProfile)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.ts\");\n\nfunction resolveName(user) {\n    const metadataName = typeof user.user_metadata?.full_name === \"string\" && user.user_metadata.full_name.trim() || typeof user.user_metadata?.name === \"string\" && user.user_metadata.name.trim() || \"\";\n    if (metadataName.length > 0) {\n        return metadataName;\n    }\n    if (user.email) {\n        const [localPart] = user.email.split(\"@\");\n        return localPart.charAt(0).toUpperCase() + localPart.slice(1);\n    }\n    return \"Permit Buddy User\";\n}\nasync function ensureProfile(user) {\n    const email = user.email ?? \"\";\n    const name = resolveName(user);\n    return _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.upsert({\n        where: {\n            id: user.id\n        },\n        update: {\n            email,\n            name\n        },\n        create: {\n            id: user.id,\n            email,\n            name\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZW5zdXJlLXByb2ZpbGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDc0M7QUFFdEMsU0FBU0MsWUFBWUMsSUFBa0I7SUFDckMsTUFBTUMsZUFDSixPQUFRRCxLQUFLRSxhQUFhLEVBQUVDLGNBQWMsWUFBWUgsS0FBS0UsYUFBYSxDQUFDQyxTQUFTLENBQUNDLElBQUksTUFDdEYsT0FBT0osS0FBS0UsYUFBYSxFQUFFRyxTQUFTLFlBQVlMLEtBQUtFLGFBQWEsQ0FBQ0csSUFBSSxDQUFDRCxJQUFJLE1BQzdFO0lBRUYsSUFBSUgsYUFBYUssTUFBTSxHQUFHLEdBQUc7UUFDM0IsT0FBT0w7SUFDVDtJQUVBLElBQUlELEtBQUtPLEtBQUssRUFBRTtRQUNkLE1BQU0sQ0FBQ0MsVUFBVSxHQUFHUixLQUFLTyxLQUFLLENBQUNFLEtBQUssQ0FBQztRQUNyQyxPQUFPRCxVQUFVRSxNQUFNLENBQUMsR0FBR0MsV0FBVyxLQUFLSCxVQUFVSSxLQUFLLENBQUM7SUFDN0Q7SUFFQSxPQUFPO0FBQ1Q7QUFFTyxlQUFlQyxjQUFjYixJQUFrQjtJQUNwRCxNQUFNTyxRQUFRUCxLQUFLTyxLQUFLLElBQUk7SUFDNUIsTUFBTUYsT0FBT04sWUFBWUM7SUFFekIsT0FBT0YsK0NBQU1BLENBQUNFLElBQUksQ0FBQ2MsTUFBTSxDQUFDO1FBQ3hCQyxPQUFPO1lBQUVDLElBQUloQixLQUFLZ0IsRUFBRTtRQUFDO1FBQ3JCQyxRQUFRO1lBQ05WO1lBQ0FGO1FBQ0Y7UUFDQWEsUUFBUTtZQUNORixJQUFJaEIsS0FBS2dCLEVBQUU7WUFDWFQ7WUFDQUY7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvZW5zdXJlLXByb2ZpbGUudHM/ZDgxMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBVc2VyIGFzIFN1cGFiYXNlVXNlciB9IGZyb20gXCJAc3VwYWJhc2Uvc3VwYWJhc2UtanNcIjtcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcblxuZnVuY3Rpb24gcmVzb2x2ZU5hbWUodXNlcjogU3VwYWJhc2VVc2VyKTogc3RyaW5nIHtcbiAgY29uc3QgbWV0YWRhdGFOYW1lID1cbiAgICAodHlwZW9mIHVzZXIudXNlcl9tZXRhZGF0YT8uZnVsbF9uYW1lID09PSBcInN0cmluZ1wiICYmIHVzZXIudXNlcl9tZXRhZGF0YS5mdWxsX25hbWUudHJpbSgpKSB8fFxuICAgICh0eXBlb2YgdXNlci51c2VyX21ldGFkYXRhPy5uYW1lID09PSBcInN0cmluZ1wiICYmIHVzZXIudXNlcl9tZXRhZGF0YS5uYW1lLnRyaW0oKSkgfHxcbiAgICBcIlwiO1xuXG4gIGlmIChtZXRhZGF0YU5hbWUubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiBtZXRhZGF0YU5hbWU7XG4gIH1cblxuICBpZiAodXNlci5lbWFpbCkge1xuICAgIGNvbnN0IFtsb2NhbFBhcnRdID0gdXNlci5lbWFpbC5zcGxpdChcIkBcIik7XG4gICAgcmV0dXJuIGxvY2FsUGFydC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGxvY2FsUGFydC5zbGljZSgxKTtcbiAgfVxuXG4gIHJldHVybiBcIlBlcm1pdCBCdWRkeSBVc2VyXCI7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbnN1cmVQcm9maWxlKHVzZXI6IFN1cGFiYXNlVXNlcikge1xuICBjb25zdCBlbWFpbCA9IHVzZXIuZW1haWwgPz8gXCJcIjtcbiAgY29uc3QgbmFtZSA9IHJlc29sdmVOYW1lKHVzZXIpO1xuXG4gIHJldHVybiBwcmlzbWEudXNlci51cHNlcnQoe1xuICAgIHdoZXJlOiB7IGlkOiB1c2VyLmlkIH0sXG4gICAgdXBkYXRlOiB7XG4gICAgICBlbWFpbCxcbiAgICAgIG5hbWUsXG4gICAgfSxcbiAgICBjcmVhdGU6IHtcbiAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgZW1haWwsXG4gICAgICBuYW1lLFxuICAgIH0sXG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsInJlc29sdmVOYW1lIiwidXNlciIsIm1ldGFkYXRhTmFtZSIsInVzZXJfbWV0YWRhdGEiLCJmdWxsX25hbWUiLCJ0cmltIiwibmFtZSIsImxlbmd0aCIsImVtYWlsIiwibG9jYWxQYXJ0Iiwic3BsaXQiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwiZW5zdXJlUHJvZmlsZSIsInVwc2VydCIsIndoZXJlIiwiaWQiLCJ1cGRhdGUiLCJjcmVhdGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/ensure-profile.ts\n");

/***/ }),

/***/ "(rsc)/./lib/prisma.ts":
/*!***********************!*\
  !*** ./lib/prisma.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst prismaClientSingleton = ()=>new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n        log: [\n            \"error\"\n        ]\n    });\nconst prisma = globalThis.prismaGlobal ?? prismaClientSingleton();\nif (true) {\n    globalThis.prismaGlobal = prisma;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQUU5QyxNQUFNQyx3QkFBd0IsSUFDNUIsSUFBSUQsd0RBQVlBLENBQUM7UUFDZkUsS0FBSztZQUFDO1NBQVE7SUFDaEI7QUFPSyxNQUFNQyxTQUFTQyxXQUFXQyxZQUFZLElBQUlKLHdCQUF3QjtBQUV6RSxJQUFJSyxJQUFxQyxFQUFFO0lBQ3pDRixXQUFXQyxZQUFZLEdBQUdGO0FBQzVCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbGliL3ByaXNtYS50cz85ODIyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xuXG5jb25zdCBwcmlzbWFDbGllbnRTaW5nbGV0b24gPSAoKSA9PlxuICBuZXcgUHJpc21hQ2xpZW50KHtcbiAgICBsb2c6IFtcImVycm9yXCJdLFxuICB9KTtcblxuZGVjbGFyZSBnbG9iYWwge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdmFyXG4gIHZhciBwcmlzbWFHbG9iYWw6IFJldHVyblR5cGU8dHlwZW9mIHByaXNtYUNsaWVudFNpbmdsZXRvbj4gfCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxUaGlzLnByaXNtYUdsb2JhbCA/PyBwcmlzbWFDbGllbnRTaW5nbGV0b24oKTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICBnbG9iYWxUaGlzLnByaXNtYUdsb2JhbCA9IHByaXNtYTtcbn1cbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWFDbGllbnRTaW5nbGV0b24iLCJsb2ciLCJwcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hR2xvYmFsIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./lib/storage.ts":
/*!************************!*\
  !*** ./lib/storage.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PERMIT_FILES_BUCKET: () => (/* binding */ PERMIT_FILES_BUCKET)\n/* harmony export */ });\nconst PERMIT_FILES_BUCKET = \"permit-files\";\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3RvcmFnZS50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQU8sTUFBTUEsc0JBQXNCLGVBQXdCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbGliL3N0b3JhZ2UudHM/NWRjOCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgUEVSTUlUX0ZJTEVTX0JVQ0tFVCA9IFwicGVybWl0LWZpbGVzXCIgYXMgY29uc3Q7XG5cbmV4cG9ydCB0eXBlIFBlcm1pdFNvdXJjZUZpbGVNZXRhID0ge1xuICBidWNrZXQ6IHN0cmluZztcbiAgcGF0aDogc3RyaW5nO1xuICBjb250ZW50VHlwZTogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHNpemU6IG51bWJlcjtcbn07XG4iXSwibmFtZXMiOlsiUEVSTUlUX0ZJTEVTX0JVQ0tFVCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/storage.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/server.ts":
/*!********************************!*\
  !*** ./lib/supabase/server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSupabaseServerClient: () => (/* binding */ createSupabaseServerClient)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n\n\nfunction createSupabaseServerClient() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const supabaseUrl = \"https://qnroanyfrzekpjruykmp.supabase.co\";\n    const supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFucm9hbnlmcnpla3BqcnV5a21wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzNDM2NDcsImV4cCI6MjA3ODkxOTY0N30.RaiNCddEVVAVHYfTFtgISA16jRia2eGkFZqNknoluTk\";\n    if (!supabaseUrl || !supabaseAnonKey) {\n        throw new Error(\"Supabase server client is not configured. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.\");\n    }\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(supabaseUrl, supabaseAnonKey, {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                cookieStore.set({\n                    name,\n                    value,\n                    ...options\n                });\n            },\n            remove (name, options) {\n                cookieStore.delete({\n                    name,\n                    ...options\n                });\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1QztBQUNZO0FBRTVDLFNBQVNFO0lBQ2QsTUFBTUMsY0FBY0gscURBQU9BO0lBQzNCLE1BQU1JLGNBQWNDLDBDQUFvQztJQUN4RCxNQUFNRyxrQkFBa0JILGtOQUF5QztJQUVqRSxJQUFJLENBQUNELGVBQWUsQ0FBQ0ksaUJBQWlCO1FBQ3BDLE1BQU0sSUFBSUUsTUFBTTtJQUNsQjtJQUVBLE9BQU9ULGlFQUFrQkEsQ0FBQ0csYUFBYUksaUJBQWlCO1FBQ3REUixTQUFTO1lBQ1BXLEtBQUlDLElBQVk7Z0JBQ2QsT0FBT1QsWUFBWVEsR0FBRyxDQUFDQyxPQUFPQztZQUNoQztZQUNBQyxLQUFJRixJQUFZLEVBQUVDLEtBQWEsRUFBRUUsT0FBOEM7Z0JBQzdFWixZQUFZVyxHQUFHLENBQUM7b0JBQUVGO29CQUFNQztvQkFBTyxHQUFHRSxPQUFPO2dCQUFDO1lBQzVDO1lBQ0FDLFFBQU9KLElBQVksRUFBRUcsT0FBOEM7Z0JBQ2pFWixZQUFZYyxNQUFNLENBQUM7b0JBQUVMO29CQUFNLEdBQUdHLE9BQU87Z0JBQUM7WUFDeEM7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzPzY2MjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIjtcbmltcG9ydCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gXCJAc3VwYWJhc2Uvc3NyXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTdXBhYmFzZVNlcnZlckNsaWVudCgpIHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKCk7XG4gIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xuICBjb25zdCBzdXBhYmFzZUFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWTtcblxuICBpZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZUFub25LZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdXBhYmFzZSBzZXJ2ZXIgY2xpZW50IGlzIG5vdCBjb25maWd1cmVkLiBTZXQgTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIGFuZCBORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWS5cIik7XG4gIH1cblxuICByZXR1cm4gY3JlYXRlU2VydmVyQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXksIHtcbiAgICBjb29raWVzOiB7XG4gICAgICBnZXQobmFtZTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXQobmFtZSk/LnZhbHVlO1xuICAgICAgfSxcbiAgICAgIHNldChuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIG9wdGlvbnM6IFBhcmFtZXRlcnM8dHlwZW9mIGNvb2tpZVN0b3JlLnNldD5bMl0pIHtcbiAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWUsIC4uLm9wdGlvbnMgfSk7XG4gICAgICB9LFxuICAgICAgcmVtb3ZlKG5hbWU6IHN0cmluZywgb3B0aW9uczogUGFyYW1ldGVyczx0eXBlb2YgY29va2llU3RvcmUuc2V0PlsyXSkge1xuICAgICAgICBjb29raWVTdG9yZS5kZWxldGUoeyBuYW1lLCAuLi5vcHRpb25zIH0pO1xuICAgICAgfSxcbiAgICB9LFxuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJjb29raWVzIiwiY3JlYXRlU2VydmVyQ2xpZW50IiwiY3JlYXRlU3VwYWJhc2VTZXJ2ZXJDbGllbnQiLCJjb29raWVTdG9yZSIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlQW5vbktleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiRXJyb3IiLCJnZXQiLCJuYW1lIiwidmFsdWUiLCJzZXQiLCJvcHRpb25zIiwicmVtb3ZlIiwiZGVsZXRlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tslib","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute&page=%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbusinesses%2F%5Bid%5D%2Fdocuments%2Froute.ts&appDir=%2Fhome%2Fmav%2Fprojects%2Fpermit-buddy%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fmav%2Fprojects%2Fpermit-buddy&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();